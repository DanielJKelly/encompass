{"version":3,"sources":["../../../app/routes/_confirm_leaving_route.js"],"names":["Encompass","ConfirmLeavingRoute","Ember","Mixin","create","confirmText","activate","route","$","window","on","get","controller","deactivate","off","actions","willTransition","transition","confirm","abort","set"],"mappings":";;AAAA;;;;;;;;AAQAA,UAAUC,mBAAV,GAAgCC,MAAMC,KAAN,CAAYC,MAAZ,CAAmB;;AAEjDC,eAAa,+EAFoC;;AAIjDC,YAAU,oBAAW;AACnB,QAAIC,QAAQ,IAAZ;AACAC,MAAEC,MAAF,EAAUC,EAAV,CAAa,kBAAkB,KAAKC,GAAL,CAAS,gBAAT,CAAlB,GAA+C,UAA5D,EAAwE,YAAW;AACjF,UAAGJ,MAAMK,UAAN,CAAiBD,GAAjB,CAAqB,gBAArB,CAAH,EAA2C;AACzC,eAAO,KAAKA,GAAL,CAAS,aAAT,CAAP;AACD;AACF,KAJD;AAKD,GAXgD;;AAajDE,cAAY,sBAAW;AACrBL,MAAEC,MAAF,EAAUK,GAAV,CAAc,kBAAkB,KAAKH,GAAL,CAAS,gBAAT,CAAlB,GAA+C,UAA7D;AACD,GAfgD;;AAiBjDI,WAAS;AACPC,oBAAgB,wBAASC,UAAT,EAAqB;AACnC,UAAIL,aAAa,KAAKD,GAAL,CAAS,YAAT,CAAjB;AACA,UAAIC,WAAWD,GAAX,CAAe,gBAAf,KACA,CAACF,OAAOS,OAAP,CAAe,KAAKP,GAAL,CAAS,aAAT,CAAf,CADL,EAC8C;AAC5CM,mBAAWE,KAAX;AACD,OAHD,MAGO;AACL;AACA;AACAP,mBAAWQ,GAAX,CAAe,SAAf,EAA0B,KAA1B,EAHK,CAG6B;AAChC;AACA;AACF,eAAO,IAAP;AACD;AACF;AAdM;;AAjBwC,CAAnB,CAAhC","file":"_confirm_leaving_route.js","sourcesContent":["/*\n # ConfirmEditingRoute - A Route Mixin\n\n This mixin will confirm navigation away from a controller where .get('confirmLeaving') is true\n It supports both transitioning away and leaving the page altogether\n It cleans up it's window event binding\n It also currently marks 'editing' false on the controller (room for improvement)\n*/\nEncompass.ConfirmLeavingRoute = Ember.Mixin.create({\n\n  confirmText: 'You have unsaved changes which you may lose.  Are you sure you want to leave?',\n\n  activate: function() {\n    var route = this;\n    $(window).on('beforeunload.' + this.get('controllerName') + '.confirm', function() {\n      if(route.controller.get('confirmLeaving')) {\n        return this.get('confirmText');\n      }\n    });\n  },\n  \n  deactivate: function() {\n    $(window).off('beforeunload.' + this.get('controllerName') + '.confirm');\n  },\n\n  actions: {\n    willTransition: function(transition) {\n      var controller = this.get('controller');\n      if (controller.get('confirmLeaving') &&\n          !window.confirm(this.get('confirmText'))) {\n        transition.abort();\n      } else {\n        // Bubble the `willTransition` action so that\n        // parent routes can decide whether or not to abort.\n        controller.set('editing', false); //always set editing to false, that way\n          //1: arbitrary nested response routes don't trigger the confirm\n          //2: reinforce that people are leaving the editing mode\n        return true;\n      }\n    }\n  }\n\n});\n"]}