{"version":3,"sources":["../../../app/models/submission.js"],"names":["Encompass","Submission","DS","Model","extend","Auditable","submissionId","Ember","computed","alias","shortAnswer","attr","longAnswer","powId","creator","creatorId","publication","uploadedFile","selections","hasMany","async","comments","workspaces","responses","folders","get","forEach","selection","pushObjects","uniq","property","selectedComments","filterBy","puzzle","puzzleUrl","imageUrl","student","label","createDate","moment","format","isStatic"],"mappings":";;AAAAA,UAAUC,UAAV,GAAuBC,GAAGC,KAAH,CAASC,MAAT,CAAgBJ,UAAUK,SAA1B,EAAqC;AAC1DC,gBAAcC,MAAMC,QAAN,CAAeC,KAAf,CAAqB,IAArB,CAD4C;AAE1DC,eAAaR,GAAGS,IAAH,CAAQ,QAAR,CAF6C;AAG1DC,cAAYV,GAAGS,IAAH,CAAQ,QAAR,CAH8C;AAI1D;;;AAGAE,SAAOX,GAAGS,IAAH,CAAQ,QAAR,CAPmD;AAQ1DG,WAASZ,GAAGS,IAAH,EARiD;AAS1DI,aAAWb,GAAGS,IAAH,CAAQ,QAAR,CAT+C;AAU1DK,eAAad,GAAGS,IAAH,EAV6C;AAW1DM,gBAAcf,GAAGS,IAAH,EAX4C;AAY1D;AACA;AACAO,cAAYhB,GAAGiB,OAAH,CAAW,WAAX,EAAwB,EAAEC,OAAO,IAAT,EAAxB,CAd8C;AAe1DC,YAAUnB,GAAGiB,OAAH,CAAW,SAAX,EAAsB,EAAEC,OAAO,IAAT,EAAtB,CAfgD;AAgB1DE,cAAYpB,GAAGiB,OAAH,CAAW,WAAX,EAAwB,EAAEC,OAAO,IAAT,EAAxB,CAhB8C;AAiB1DG,aAAWrB,GAAGiB,OAAH,CAAW,UAAX,EAAuB,EAAEC,OAAO,IAAT,EAAvB,CAjB+C;;AAmB1DI,WAAS,YAAY;AACnB,QAAIA,UAAU,EAAd;AACA,SAAKC,GAAL,CAAS,YAAT,EAAuBC,OAAvB,CAA+B,UAAUC,SAAV,EAAqB;AAClDH,cAAQI,WAAR,CAAoBD,UAAUF,GAAV,CAAc,SAAd,CAApB;AACD,KAFD;AAGA,WAAOD,QAAQK,IAAR,EAAP;AACD,GANQ,CAMPC,QANO,CAME,uBANF,CAnBiD;;AA2B1DC,oBAAkB,YAAY;AAC5B,WAAO,KAAKN,GAAL,CAAS,UAAT,EAAqBO,QAArB,CAA8B,gBAA9B,EAAgD,IAAhD,CAAP;AACD,GAFiB,CAEhBF,QAFgB,CAEP,4BAFO,CA3BwC;;AA+B1DG,UAAQ,YAAY;AAClB,WAAO,KAAKR,GAAL,CAAS,oBAAT,CAAP;AACD,GAFO,CAENK,QAFM,EA/BkD;;AAmC1DI,aAAW,YAAY;AACrB,WAAO,kCAAkC,KAAKT,GAAL,CAAS,iBAAT,CAAzC;AACD,GAFU,CAETK,QAFS,EAnC+C;;AAuC1D;;;;;;AAMAK,YAAU,YAAY;AACpB,WAAO,kDAAkD,KAAKV,GAAL,CAAS,0BAAT,CAAzD;AACD,GAFS,CAERK,QAFQ,EA7CgD;;AAiD1DM,WAAS,YAAY;AACnB,QAAIA,UAAU,KAAKX,GAAL,CAAS,kBAAT,CAAd;AACA,WAAOW,OAAP;AACD,GAHQ,CAGPN,QAHO,CAGE,kBAHF,CAjDiD;;AAsD1DO,SAAO,YAAY;AACjB,QAAIA,QAAQ,KAAKZ,GAAL,CAAS,SAAT,CAAZ;AACA,QAAIa,aAAa,KAAKb,GAAL,CAAS,YAAT,CAAjB;AACA,QAAIa,UAAJ,EAAgB;AACdD,eAAS,SAASE,OAAOD,UAAP,EAAmBE,MAAnB,CAA0B,GAA1B,CAAlB;AACD;AACDH,aAAS,OAAO,KAAKZ,GAAL,CAAS,sBAAT,CAAP,GAA0C,GAAnD;AACA,WAAOY,KAAP;AACD,GARM,CAQLP,QARK,CAQI,SARJ,EAQe,YARf,EAQ6B,sBAR7B,CAtDmD;;AAgE1DW,YAAU,YAAY;AACpB,WAAO,CAAC,KAAKhB,GAAL,CAAS,OAAT,CAAR;AACD,GAFS,CAERK,QAFQ,CAEC,OAFD;AAhEgD,CAArC,CAAvB","file":"submission.js","sourcesContent":["Encompass.Submission = DS.Model.extend(Encompass.Auditable, {\n  submissionId: Ember.computed.alias('id'),\n  shortAnswer: DS.attr('string'),\n  longAnswer: DS.attr('string'),\n  /*\n   * the powId is the ID for this submission in the PoW environment\n   */\n  powId: DS.attr('number'),\n  creator: DS.attr(),\n  creatorId: DS.attr('number'),\n  publication: DS.attr(),\n  uploadedFile: DS.attr(),\n  //teacher, class, puzzle TODO\n  //teacher: DS.belongsTo(App.User, {embedded:'always'}),\n  selections: DS.hasMany('selection', { async: true }),\n  comments: DS.hasMany('comment', { async: true }),\n  workspaces: DS.hasMany('workspace', { async: true }),\n  responses: DS.hasMany('response', { async: true }),\n\n  folders: function () {\n    var folders = [];\n    this.get('selections').forEach(function (selection) {\n      folders.pushObjects(selection.get('folders'));\n    });\n    return folders.uniq();\n  }.property('selections.[].folders'),\n\n  selectedComments: function () {\n    return this.get('comments').filterBy('useForResponse', true);\n  }.property('comments.[].useForResponse'),\n\n  puzzle: function () {\n    return this.get('publication.puzzle');\n  }.property(),\n\n  puzzleUrl: function () {\n    return '/library/go.html?destination=' + this.get('puzzle.puzzleId');\n  }.property(),\n\n  /*\n  attachment: function(){\n    return this.get('data.uploadedFile');\n  }.property(),\n  */\n\n  imageUrl: function () {\n    return 'http://mathforum.org/encpows/uploaded-images/' + this.get('attachment.savedFileName');\n  }.property(),\n\n  student: function () {\n    var student = this.get('creator.safeName');\n    return student;\n  }.property('creator.safeName'),\n\n  label: function () {\n    var label = this.get('student');\n    var createDate = this.get('createDate');\n    if (createDate) {\n      label += ' on ' + moment(createDate).format('l');\n    }\n    label += ' (' + this.get('data.thread.threadId') + ')';\n    return label;\n  }.property('student', 'createDate', 'data.thread.threadId'),\n\n  isStatic: function () {\n    return !this.get('powId');\n  }.property('powId')\n});\n"]}