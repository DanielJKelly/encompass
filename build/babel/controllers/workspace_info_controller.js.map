{"version":3,"sources":["../../../app/controllers/workspace_info_controller.js"],"names":["Encompass","WorkspaceInfoController","Ember","Controller","extend","CurrentUserMixin","comments","inject","controller","isEditing","selectedValue","searchText","searchResults","get","replace","length","people","store","find","name","property","canEdit","Permissions","userCanModifyWorkspace","modes","modeValues","actions","removeEditor","editor","workspace","removeObject","addEditor","contains","pushObject","changeMode","mode","set","editWorkspace","saveWorkspace","call","save","then"],"mappings":";;AAAA;;;;;;;AAOAA,UAAUC,uBAAV,GAAoCC,MAAMC,UAAN,CAAiBC,MAAjB,CAAwBJ,UAAUK,gBAAlC,EAAoD;;AAEtFC,YAAUJ,MAAMK,MAAN,CAAaC,UAAb,EAF4E;;AAItFC,aAAW,KAJ2E;AAKtFC,iBAAe,IALuE;AAMtFC,cAAY,EAN0E;AAOtFC,iBAAe,YAAW;AACxB,QAAID,aAAa,KAAKE,GAAL,CAAS,YAAT,CAAjB;AACAF,iBAAaA,WAAWG,OAAX,CAAmB,MAAnB,EAA2B,EAA3B,CAAb;AACA,QAAGH,WAAWI,MAAX,GAAoB,CAAvB,EAA0B;AAAE;AAAS;;AAErC,QAAIC,SAAS,KAAKC,KAAL,CAAWC,IAAX,CAAgB,MAAhB,EAAwB,EAAEC,MAAMR,UAAR,EAAxB,CAAb;AACA,WAAOK,MAAP;AACD,GAPc,CAObI,QAPa,CAOJ,YAPI,CAPuE;AAetFC,WAAS,YAAW;AAClB,QAAIA,UAAUC,YAAYC,sBAAZ,CAAmC,KAAKV,GAAL,CAAS,aAAT,CAAnC,EAA4D,KAAKA,GAAL,CAAS,OAAT,CAA5D,CAAd;AACA,WAAOQ,OAAP;AACD,GAHQ,CAGPD,QAHO,CAGE,OAHF,CAf6E;AAmBtFI,SAAO,YAAU;AACf,WAAOF,YAAYG,UAAZ,EAAP;AACD,GAFM,CAELL,QAFK,EAnB+E;AAsBtFM,WAAS;AACPC,kBAAc,sBAASC,MAAT,EAAgB;AAC5B,UAAIC,YAAY,KAAKhB,GAAL,CAAS,OAAT,CAAhB;AACAgB,gBAAUhB,GAAV,CAAc,SAAd,EAAyBiB,YAAzB,CAAsCF,MAAtC;AACD,KAJM;AAKPG,eAAW,mBAASH,MAAT,EAAgB;AACzB,UAAIC,YAAY,KAAKhB,GAAL,CAAS,OAAT,CAAhB;AACA,UAAG,CAACgB,UAAUhB,GAAV,CAAc,SAAd,EAAyBmB,QAAzB,CAAkCJ,MAAlC,CAAJ,EAA+C;AAC7CC,kBAAUhB,GAAV,CAAc,SAAd,EAAyBoB,UAAzB,CAAoCL,MAApC;AACD;AACF,KAVM;AAWPM,gBAAY,sBAAW;AACrB,UAAIC,OAAO,KAAKtB,GAAL,CAAS,cAAT,CAAX;AACA,UAAIgB,YAAY,KAAKhB,GAAL,CAAS,OAAT,CAAhB;AACAgB,gBAAUO,GAAV,CAAc,MAAd,EAAsBD,IAAtB;AACD,KAfM;AAgBPE,mBAAe,yBAAU;AACvB,WAAKD,GAAL,CAAS,WAAT,EAAsB,IAAtB;AACD,KAlBM;AAmBPE,mBAAe,yBAAU;AACvB,WAAKZ,OAAL,CAAaQ,UAAb,CAAwBK,IAAxB,CAA6B,IAA7B;AACA,UAAIV,YAAY,KAAKhB,GAAL,CAAS,OAAT,CAAhB;AACA,UAAIL,aAAa,IAAjB;AACAqB,gBAAUW,IAAV,GAAiBC,IAAjB,CAAsB,YAAU;AAC9BjC,mBAAW4B,GAAX,CAAe,WAAf,EAA4B,KAA5B;AACD,OAFD;AAGD;AA1BM;AAtB6E,CAApD,CAApC","file":"workspace_info_controller.js","sourcesContent":["/**\n  * # Workspace Info Controller\n  * @description This controller for the workspace assists in linking between submissions\n  * @todo Linking between submissions should really be moved to workspace_submissions_index_controller\n  * @author Amir Tahvildaran <amir@mathforum.org>, Damola Mabogunje <damola@mathforum.org>\n  * @since 1.0.0\n*/\nEncompass.WorkspaceInfoController = Ember.Controller.extend(Encompass.CurrentUserMixin, {\n\n  comments: Ember.inject.controller(),\n\n  isEditing: false,\n  selectedValue: null,\n  searchText: \"\",\n  searchResults: function() {\n    var searchText = this.get('searchText');\n    searchText = searchText.replace(/\\W+/g, \"\");\n    if(searchText.length < 2) { return; }\n\n    var people = this.store.find('user', { name: searchText });\n    return people;\n  }.property('searchText'),\n  canEdit: function() {\n    var canEdit = Permissions.userCanModifyWorkspace(this.get('currentUser'), this.get('model'));\n    return canEdit;\n  }.property('owner'),\n  modes: function(){\n    return Permissions.modeValues();\n  }.property(),\n  actions: {\n    removeEditor: function(editor){\n      var workspace = this.get('model');\n      workspace.get('editors').removeObject(editor);\n    },\n    addEditor: function(editor){\n      var workspace = this.get('model');\n      if(!workspace.get('editors').contains(editor)) {\n        workspace.get('editors').pushObject(editor);\n      }\n    },\n    changeMode: function() {\n      var mode = this.get('selectedMode');\n      var workspace = this.get('model');\n      workspace.set('mode', mode);\n    },\n    editWorkspace: function(){\n      this.set('isEditing', true);\n    },\n    saveWorkspace: function(){\n      this.actions.changeMode.call(this);\n      var workspace = this.get('model');\n      var controller = this;\n      workspace.save().then(function(){\n        controller.set('isEditing', false);\n      });\n    }\n  }\n});\n"]}